ec.pkg("ec.index");"use strict";var Slider=function(a){this.i=0;this.objid=a.objid||null;this.preclassname=a.preclassname||".btn-prev";this.nextclassname=a.nextclassname||".btn-next";this.listname=a.listname||".grid-list";this.listitem=a.listitem||"li";this.shownum=a.shownum||5.5;this.type=a.type||1;this.autoplay=a.autoplay||false};Slider.prototype={init:function(){var b=this;var a=b.set();if(b.autoplay){b.auto(a)}else{b.next(a);b.pre(a)}},auto:function(e){var d=this,c=null;$(d.listname).find(d.listitem).eq(0).clone().appendTo(d.listname);var a=function(){d.i+=d.shownum;e.$grid.animate({"margin-top":"-"+d.i*e.itemHeight+"px"},500,"swing",function(){if(d.i>=e.len){d.i=0;e.$grid.css("margin-top",0)}})};if(d.autoplay){c=setInterval(a,2e3);e.$grid.hover(function(){clearInterval(c)},function(){c=setInterval(a,2e3)})}},set:function(){var d=this,g=$(d.objid+" "+d.listitem),i=$(d.objid+" "+d.listname),h=$(d.objid+" "+d.preclassname),b=$(d.objid+" "+d.nextclassname),e=g.length,f=g.outerWidth(),a=g.outerHeight(),c=Math.ceil(e/d.shownum);switch(d.type){default:case 1:i.css("width",(f+1)*e+"px");break;case 2:i.css("height",a*e+"px");break}return{$item:g,$grid:i,$pre:h,$next:b,len:e,itemWidth:f,itemHeight:a,num:c}},pre:function(b){var a=this;b.$pre.bind("click",function(){if($(this).hasClass("disabled")){return}a.i--;if(a.i-1<0){b.$pre.addClass("disabled")}b.$next.removeClass("disabled");switch(a.type){default:case 1:b.$grid.animate({"margin-left":a.i==0?0:parseInt(b.$grid.css("margin-left"))+b.itemWidth*a.shownum+"px"},500);break;case 2:b.$grid.animate({"margin-top":a.i==0?0:parseInt(b.$grid.css("margin-top"))+b.itemHeight*a.shownum+"px"},500)}})},next:function(b){var a=this;b.$next.bind("click",function(){if($(this).hasClass("disabled")){return}a.i++;b.$pre.removeClass("disabled");switch(a.type){default:case 1:if(a.shownum>1){if(a.i+1==b.num){var d=parseInt(b.$grid.css("margin-left"));var c=(b.len-a.i*parseInt(a.shownum)-1/2)*b.itemWidth;b.$grid.animate({"margin-left":d-c+"px"},500)}else{b.$grid.animate({"margin-left":"-"+a.i*b.itemWidth*parseInt(a.shownum)+"px"},500)}}else{b.$grid.animate({"margin-left":"-"+a.i*b.itemWidth*a.shownum+"px"},500)}break;case 2:b.$grid.animate({"margin-top":"-"+a.i*b.itemHeight*a.shownum+"px"},500);break}if(a.i+1==b.num){b.$next.addClass("disabled")}})}};ec.index.clickHref=function(a){ec.openWindow(a)};ec.index.sales=function(e){};ec.index.salesStatus=[];ec.index.salesCallBack=function(h,k){var f,d=[],b=new Date;b.setTime(ec.util.parseDate(ec.index.now));var a=function(i,o){var n=$(o),l=n.attr("data-skutype"),m=$(".channel-button",n);switch(parseInt(i,10)){case 0:m.html("马上开始").attr("title","马上开始");if(l==3||l==4){m.attr("class","channel-button-begin")}break;case 1:if(l==3){m.html("去看看").attr("title","去看看")}else{m.html("立即抢购").attr("title","立即抢购")}m.attr("class","channel-button");break;case 2:m.html("活动结束").attr("title","活动结束");if(l==2||l==3){m.attr("class","channel-button-end")}break}};for(var c=0;c<k.infoList.length;c+=1){f=h[c];d=k.infoList[c];$(".channel-button",f).css("visibility","");if(!d||!d.id){continue}if(d.status==1){if(d.startTime&&d.startTime>=b){d.status=0}if(d.endTime&&d.endTime<=b){d.status=2}}a(d.status,f);if(d.startTime||d.endTime||d.limitAmount>0){$(".p-countdown",f).show()}if(d.limitAmount>0){$(".p-quantity",f).html("限<b>"+d.limitAmount+"</b>台").show()}var e=parseFloat($(f).attr("data-price"),10);if(d.price>0){if(parseInt(d.price)==d.price){$(".p-sale-price span, .p-price span",f).html(d.price);if(parseInt(e)==e){$(".economize",f).html(e-d.price)}else{$(".economize",f).html((e-d.price).toFixed(2))}}else{$(".p-sale-price span, .p-price span",f).html(d.price.toFixed(2));if(e-d.price==0){$(".economize",f).html("0")}else{$(".economize",f).html((e-d.price).toFixed(2))}}}$(".sale-quantity",f).html(d.saleAmount);if(d.status!=2&&(d.startTime||d.endTime)){var g=$(f).attr("data-block")=="slider"?true:false,j=[];if(d.startTime){j.push(ec.util.parseDate(d.startTime).format("yyyy-MM-dd HH:mm:ss"))}if(d.endTime){j.push(ec.util.parseDate(d.endTime).format("yyyy-MM-dd HH:mm:ss"))}ec.index.salesStatus[c]=d.status;ec.ui.countdown($(".p-time",f),{html:"<b>"+(g?"":"剩余")+"</b><ins><i>{#hours}</i><s></s></ins><em>时</em><ins><i>{#minutes}</i><s></s></ins><em>分</em><ins><i>{#seconds}</i><s></s></ins><em>秒</em>",now:b,times:j,index:c,callback:function(i){ec.index.salesStatus[i.index]++;a(ec.index.salesStatus[i.index],h[i.index])}})}}};ec.ready(function(){var skuids=$("#recommendSkuIds").val();ec.dapClick(300011501,{SKUID:skuids,load:"1"});if(ec.account.isLogin()){$("#cust_login_info").hide()}var a=ec.index.bigAd,g=ec.index.smallAd,f=ec.index.bigadShowTime,e,b,c=function(){var j=b.innerHeight();var i=e.innerHeight();var k=$("#search-bar-form").offset().top-i+j;var h=$("#search-bar-form").innerHeight();$(".autocomplete-w1").parent().hide();e.slideUp(1e3,function(){if(g){b.show()}$(".autocomplete-w1").parent().css({top:k+h+"px"});$(".autocomplete-w1").parent().show();ec.index.SCROLL_GET=ec.index.getscrollLayout()});if(d){clearTimeout(d)}},d;$("#top-banner-block").html(gid("top-banner").value);e=$("#top-banner-max");b=$("#top-banner-min");$("#top-banner-min-close").click(function(){$("#top-banner-block").hide();ec.index.SCROLL_GET=ec.index.getscrollLayout()});if(a){e.show();ec.index.SCROLL_GET=ec.index.getscrollLayout();$("#top-banner-max-toggle").click(c);d=setTimeout(c,f)}if(g&&!a){b.show();ec.index.SCROLL_GET=ec.index.getscrollLayout()}if(!g&&!a){ec.index.SCROLL_GET=ec.index.getscrollLayout()}$("body .layout .channel-pro-item").hover(function(){$(this).addClass("pro-info-hover")},function(){$(this).removeClass("pro-info-hover")});ec.index.sales("#main-sale-list .activity-list, #slider-sale-list .activity-list");ec.index.floatLayout()});ec.index.SCROLL_GET={};ec.index.getscrollLayout=function(){var b=$(".home-channel-container .layout .channel-title").closest(".layout"),d=$(".event-float-layout"),a=[],c=[];if(b.length==0||d.length==0){return false}b.each(function(e,f){c.push($(this).offset().top);a.push($(this).outerHeight())});return{scrollListHeight:a,scrollList:c,top:d.offset().top}};ec.index.floatLayout=function(){var a=$(".event-float-layout");if(a.length==0||ec.index.SCROLL_GET===false){return false}$("body").css({"min-width":"1200px","overflow-x":"hidden"});var d=$(".event-float"),n=$(".hungBar-top"),h=$(".home-channel-container .layout .channel-title").closest(".layout"),p=$(".home-channel-container"),m=$(".home-channel-container .layout .channel-title"),l="";a.find("ul").children().remove();function f(i){return $("<span/>").textS(i).html()}h.each(function(i,q){var name=f(m.eq(i).text());l+='<li><a data-id="'+i+'" href="javascript:;" onclick = "pushMsg(\''+ec.encodeForJS(name)+"');\">"+ec.autoEncodeAttr(name)+"</a></li>"});a.find("ul").append(l);a.bind("click",function(r){var q=$(r.target);if(q[0].nodeName.toLowerCase()==="a"){var i=parseInt(q.attr("data-id"));q.parent().addClass("hover").siblings().removeClass("hover");$("html,body").animate({scrollTop:ec.index.SCROLL_GET.scrollList[i]+"px"},400)}});var o=a.outerHeight(),e=d.offset(),c=e.left,b=$(window).height(),k=b/2-o/2,j=h.length,g=true;a.css({height:j*47+"px",top:k+"px"});if(document.body.clientWidth<=1400){a.hide();g=false}if($.browser.msie&&parseInt($.browser.version)<=9){a.hide()}if($.browser.msie&&parseInt($.browser.version)<=7){g=false}else{$(window).scroll(function(){if(!g){return}var i=$(window).scrollTop();if(i>=b){n.fadeIn(80)}else{n.fadeOut(80)}if(i>=ec.index.SCROLL_GET.scrollList[0]-k){a.css({top:k+"px"}).addClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9){a.show()}$.each(ec.index.SCROLL_GET.scrollList,function(q,r){if(i>=r-ec.index.SCROLL_GET.scrollListHeight[q]/2){a.find("li").eq(q).addClass("hover").siblings().removeClass("hover")}});if(i>=ec.index.SCROLL_GET.scrollList[j-1]+200){a.removeClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9){a.hide()}}}else{a.removeClass("tool-Fixed");if($.browser.msie&&parseInt($.browser.version)>=8&&parseInt($.browser.version)<=9){a.hide()}}})}$(window).resize(function(){if(document.body.clientWidth>1400){a.show();g=true;return}a.hide();g=false;$("body").css({"min-width":"1200px","overflow-x":"auto"})});if($(window).scrollTop()>0){$(window).trigger("scroll")}};function initSwiper(xpath,num){var jobj=$(xpath);var liNum=jobj.find(".swiper-slide").length;if(liNum>num){jobj.find(".swiper-button-next").removeClass("disabled")}else{jobj.find(".swiper-button-prev").addClass("disabled");jobj.find(".swiper-button-next").addClass("disabled")}var mySwiper=new Swiper(xpath,{slidesPerView:num,slidesPerGroup:num});jobj.find(".btn-prev").click(function(){mySwiper.swipePrev()});jobj.find(".btn-next").click(function(){mySwiper.swipeNext()})}$(document).ready(function(){new Slider({objid:"#notice",listname:".p-notice-list",shownum:1,type:2,autoplay:true}).init();var b=$(".bottomImage");if(b.attr("src")){b.show().bind("click",function(){var f=$("#adsArearLink").val();if(f!=null&&f.trim()!=""){var g=ec.openWindow(f);g.opener=null}})}var e=$(".grid-list .grid-items,.grid-promo-list .grid-items");e.hover(function(){$(this).addClass("current")},function(){$(this).removeClass("current")})});(function(){function floatShow(){function getScrollTop(){var scrollTop=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;return scrollTop}if(getScrollTop()>1080){if($(".leftfloat")){$(".leftfloat").addClass("leftfloat-show")}}else{if($(".leftfloat")){$(".leftfloat").removeClass("leftfloat-show")}}}floatShow();window.onscroll=function(){floatShow()};function floatPosition(){if($(".leftfloat")){var floatLeft=($(window).width()-1200)/2-$(".leftfloat").width()-10,floatTop=$(window).height()/2-$(".leftfloat").height()/2;$(".leftfloat").css("left",floatLeft);$(".leftfloat").css("top",floatTop);setTimeout(floatPosition,100)}}floatPosition();window.onresize=function(){floatPosition()};var $top=$(".home-channel-container .layout").eq(0).offset().top,$height=$(".bottom-banner").height();$(window).scroll(function(){var bottomV=$height*-1;$(".bottom-banner").css("bottom",bottomV+"px");var scrollTop=$(window).scrollTop();if(scrollTop>=$top-$height){$(".footer-container").css("padding-bottom",$height+"px");$(".bottom-banner").addClass("bm-0")}else{$(".bottom-banner").removeClass("bm-0");$(".footer-container").css("padding-bottom","0")}})})();function pushMemberMsg(name,url){if(url.indexOf("privilege")!=-1||url.indexOf("welcome.html")!=-1){}else if(name.indexOf("注册")!=-1){}else{ec.account.afterLogin(function(){})}ec.dapClick(300010801,{name:name,URL:url,click:"1"})}function pushFoolMsg(index,category,url){ec.dapClick(300011703,{index:index,category:category,URL:url,click:"1"})}function pushFoolChildrenMsg(index,category,subCategory,url){ec.dapClick(300011701,{index:index,category:category,subCategory:subCategory,URL:url,click:"1"})}$("#j-footer").on("click",".ad.fl a",function(){ec.dapClick(300011801,{name:$(this).find("img").attr("src"),URL:$(this).attr("href"),click:"1"})});function pushFoolAdvertMsg(index,category,adid,url){ec.dapClick(300011702,{index:index,category:category.transHtmlAttribute(),ADID:adid,URL:url,click:"1"})}$(".hover-list").find("li").find("a").click(function(){ec.dapClick(300010001,{buttonName:$(this).html(),click:"1"})});$("#web_popup_ads").find("a").click(function(){ec.dapClick(300010002,{ADID:$(this).find("img").attr("src"),URL:$(this).attr("href"),click:"1"})});function pushFoolGoodsMsg(obj,location,index,category,skuId,type){var row,column;if(type=="13"){if(location<5){row=1;column=location+1}else{row=Math.floor(location/5)+1;column=location%5+1}}else if(type=="12"){row=parseInt((location-1)/5)+1;column=parseInt((location-1)%5)+1}var url=obj.href;ec.dapClick(300011704,{index:index,category:category,SKUID:skuId,URL:url,row:""+row,"column ":""+column,click:"1"})}$(".top-banner-min").find("a").live("click",function(){var name=$(this).attr("title");var type;var src;var url;if($(this).attr("class")=="undefined"||$(this).attr("class")==""||$(this).attr("class")==null){type="1";src=$(this).find("img").attr("src");url=$(this).attr("href")}else{type="2";src="";url=""}ec.dapClick(300010102,{ADID:src,URL:url,type:type,click:"1"})});$(".top-banner-max").find("a").live("click",function(){var name=$(this).attr("title");var type;var src;var url;if($(this).attr("class")=="undefined"||$(this).attr("class")==""||$(this).attr("class")==null){type="1";src=$(this).find("img").attr("src");url=$(this).attr("href")}else{type="2";src="";url=""}ec.dapClick(300010101,{ADID:src,URL:url,type:type,click:"1"})});function pushMsg(name){ec.dapClick(300010001,{buttonName:name,click:"1"})}function pushMsgMenu1(location,key,name,url){ec.account.afterLogin(function(){ec.redirectTo("/priority")});ec.dapClick(key,{name:name,URL:url,location:location,click:"1"})}function pushMsgMenu(location,key,name,url){ec.dapClick(key,{name:name,URL:url,location:location,click:"1"})}function pushMsgNotice(location){ec.dapClick(300011001,{location:location,click:"1"})}$(".home-promo-list.clearfix li a").click(function(){ec.dapClick(300011201,{ADID:$(this).parent().find("img").attr("src"),URL:$(this).attr("href"),location:$(this).parent().index()+1,click:"1"})});function pushGoodsRecommendMsg(skuid,obj,location){ec.dapClick(300011501,{SKUID:skuid,URL:obj.href,location:location,click:"1"})}$(function(){function lazyLoadImg(jqObjs){jqObjs.each(function(){var _self=$(this);var url=_self.attr("data-lazy-src");if(url){_self.attr("src",url).removeAttr("data-lazy-src")}})}var moreLoaded=false;function loadMore(){var loadRecom=function(){lazyLoadImg($("#j-goods-recommend img"));$("#j-goods-recommend .goods-rolling").each(function(){var xpathId=$(this).attr("id");initSwiper("#"+xpathId,5)})};var loadList=function(){lazyLoadImg($("#j-goods-list img"));$("#j-goods-list .goods-rolling").each(function(){var xpathId=$(this).attr("id");initSwiper("#"+xpathId,6)});ec.index.SCROLL_GET=ec.index.getscrollLayout();ec.index.floatLayout();$(".home-banner-slideshow").each(function(){$(this).find("ul li a").each(function(idx,self){$(self).click(function(){ec.dapClick("300012001",{index:$(self).closest(".home-banner-slideshow").attr("data-floor"),ADID:$(self).find("img").attr("src"),URL:$(self).attr("href"),location:idx+1,click:1})})})})};if($("#loadIndexType").val()=="preview"){$("#j-goods-recommend").load("/goodsRecommendPreview.html",loadRecom);$("#j-goods-list").load("/goodslistpreview.html",loadList)}else{$("#j-goods-recommend").load("/goodsRecommend.html",loadRecom);$("#j-goods-list").load("/goodslist.html",loadList)}$("#j-footer").load("/footer.html",function(){$("#j-copyrightyear").text((new Date).getFullYear());new Slider({objid:"#serverlink",listname:".service-list",listitem:"ol",shownum:1}).init();$(".fl").find("dd").find("a").bind("click",function(){var HREF="";HREF=this.href;var name=this.innerHTML;if(HREF==null||HREF==""){return}if(this.id=="tools-nav-service-robotim-button"){name="在线客服"}if(this.className=="service-btn btn-report"){name="不良信息举报"}pushFootAdvertMsg(name,HREF)});$("#serverlink a").each(function(){var $a=$(this);var url=$a.attr("onclick")||"";url=url.toString();var m=url.match(/jump_link\('([^']+)'\)/);if(m&&m[1]){url=m[1];$a.attr("target","_blank").attr("href",url)}})})}if($("body").height()<=$(window).height()&&!moreLoaded){moreLoaded=true;loadMore()}$(window).scroll(function(){if(!moreLoaded){moreLoaded=true;loadMore()}})});ec.popMarketingMessage={init:function(){var obj=this;if(!ec.account.isLogin()){return false}$.ajax({url:openApiDomain+"/mcp/imm/getTargetMessage",dataType:"json",contentType:"text/plain",data:{lang:"zh-CN",country:"CN",portal:1,ownedPage:1},success:function(r){if(!r||!r.success||!r.pageMarketingMessageInfo||!r.pageMarketingMessageInfo.custTitle&&!r.pageMarketingMessageInfo.custContent){obj.next();return false}obj.showBox(r.pageMarketingMessageInfo,r.activityCode)},error:function(){obj.next();return false}})},next:function(){if(ec.groupad&&"function"===typeof ec.groupad.init){ec.groupad.init()}},showBox:function(pmm,activityCode){var obj=this;var html="";var btns={};var box={};pmm.interactButtonInfoList.forEach(function(btn){if(btn.buttonType===1)btns.ok=btn;else if(btn.buttonType===2)btns.cancel=btn;else if(btn.buttonType===3)btns.notagain=btn});var opt={boxid:"jb-marketing-message",boxclass:"ol_box_4",width:702,title:pmm.custTitle,okBtnName:btns.ok.buttonTitle,cancelBtnName:btns.cancel.buttonTitle,oncancel:function(){box.close();obj.feedback(activityCode,btns.cancel)},onok:function(){box.close();obj.feedback(activityCode,btns.ok)}};pmm.custContent=XSS.decode(pmm.custContent);if(pmm.picWebUrl){var img=new Image;img.src=XSS.decode(pmm.picWebUrl);img.onload=function(){var w=this.width,h=this.height;var height=Math.round(h/w*660);html+='<p><img src="'+pmm.picWebUrl+'" width="660" height="'+height+'"></p>';if(pmm.custContent){html+="<div>"+pmm.custContent+"</div>"}html='<div class="box-img" style="margin-top: 30px;">'+html+"</div>";box=new ec.box(html,opt).open()}}else{html='<div class="box-img" style="margin-top: 20px; line-height: 27px; text-align: center;">'+pmm.custContent+"</div>";opt.width=460;box=new ec.box(html,opt).open()}},feedback:function(activityCode,btn,unsubscribeFlag,contentJson){var obj=this;$.ajax({url:openApiDomain+"/mcp/imm/userMessageFeedBack",method:"post",dataType:"json",contentType:"text/plain",data:JSON.stringify({lang:"zh-CN",country:"CN",portal:1,activityCode:activityCode,buttonType:btn.buttonType,unsubscribeFlag:unsubscribeFlag,contentJson:contentJson}),complete:function(){if(btn.buttonEvent===2){if(btn.buttonJumpUrl)location.href=XSS.decode(btn.buttonJumpUrl)}else if(btn.buttonEvent===4){location.href="/member/order"}obj.next()}})}};